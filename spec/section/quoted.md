## Generating quoted triples with RML-star {#quoted}

A <dfn>Star Map</dfn> (`rml:StarMap`) is similar to a [term map](https://rml.io/specs/rml/#term-map) that generates [quoted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted).
It can be used within Subject or Object Maps.
A Star Map is linked to a [Triples Map](https://rml.io/specs/rml/#triples-map) by the <dfn>quoted Triples Map</dfn> property (`rml:quotedTriplesMap`).
The [quoted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted) generated by a [=Star Map=] are exactly those triples generated by its [=quoted Triples Map=].
If a Star Map has the same [logical source](https://rml.io/specs/rml/#logical-source) as its [=quoted Triples Map=], then for each [logical iteration](https://rml.io/specs/rml/#iterator), the [quoted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted) generated by a Star Map are those triples generated by its [=quoted Triples Map=] *for the same logical iteration*.
If a Star Map has a different logical source than its quoted Triples Map then a join is used, as described in [the next section](#join).

In the following example, for each logical iteration (i.e., each CSV row) a "type" triple is generated by `<#innerTriplesMap>` that occurs
in the resulting graph both as an asserted and as a quoted triple:

<pre class="ex-input">
# Contents of the ex:ConfidenceSource logical source
entity , class  , confidence
Alice  , Person , 0.8
Bobby  , Dog    , 0.6
</pre>

<pre class="ex-mapping nohighlight">
# Triples Map that generates "type" triples that are asserted and quoted
<#innerTriplesMap>
    a rml:AssertedTriplesMap;
    rml:logicalSource ex:ConfidenceSource;
    rml:subjectMap [
        rml:template "http://example.com/{entity}"
    ];
    rml:predicateObjectMap [
        rml:predicate rdf:type;
        rml:objectMap [ rml:template "http://example.com/{class}" ];
    ].

# Triples Map that generates "confidence" triples
<#outerTriplesMap>
    a rml:AssertedTriplesMap;
    rml:logicalSource ex:ConfidenceSource;
    rml:subjectMap [
        <b>rml:quotedTriplesMap <#innerTriplesMap>;</b>
    ];
    rml:predicateObjectMap [
        rml:predicate ex:confidence;
        rml:objectMap [ rml:reference "confidence" ];
    ].
</pre>

<pre class="ex-output">
# Triples generated by <#innerTriplesMap>
ex:Alice a ex:Person .
ex:Bobby a ex:Dog .

# Triples generated by <#outerTriplesMap>
<< ex:Alice a ex:Person >> ex:confidence 0.8 .
<< ex:Bobby a ex:Dog >> ex:confidence 0.6 .
</pre>


The previous example shows a [quoted triple](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted) within a Subject Map.
Since [quoted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted) can be both subjects or objects, [=Star Maps=] can also
be used in the position of Object Maps, as shown in the following example:

<pre class="ex-input">
# Contents of the ex:ConfidenceSource logical source
entity , pet     , class
Alice  , Bobby   , Dog
Steve  , Pumpkin , Cat
</pre>

<pre class="ex-mapping nohighlight">
# Triples Map that generates "type" triples that are asserted and quoted
<#innerTriplesMap>
    a rml:AssertedTriplesMap;
    rml:logicalSource ex:ConfidenceSource;
    rml:subjectMap [
        rml:template "http://example.com/{pet}"
    ];
    rml:predicateObjectMap [
        rml:predicate rdf:type;
        rml:objectMap [ rml:template "http://example.com/{class}" ];
    ].

# Triples Map that generates "has pet" triples
<#outerTriplesMap>
    a rml:AssertedTriplesMap;
    rml:logicalSource ex:ConfidenceSource;
    rml:subjectMap [
        rml:template "http://example.com/{entity}";
    ];
    rml:predicateObjectMap [
        rml:predicate ex:has_pet;
        <b>rml:objectMap [ rml:quotedTriplesMap <#innerTriplesMap> ];</b>
    ].
</pre>

<pre class="ex-output">
# Triples generated by <#innerTriplesMap>
ex:Bobby a ex:Dog .
ex:Pumpkin a ex:Cat .

# Triples generated by <#outerTriplesMap>
ex:Alice ex:has_pet << ex:Bobby a ex:Dog >> .
ex:Steve ex:has_pet << ex:Pumpkin a ex:Cat >> .
</pre>

By default, triples generated by a Triples Map are generated as [asserted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-asserted).
If the Triples Map is also used in a [=Star Map=], the triples it generates *also* occur in the resulting graph as [quoted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted), by the process explained above.
The generation of asserted triples by a Triples Map can be supressed by declaring it an <dfn>non-asserted Triples Map</dfn> (`rml:NonAssertedTriplesMap`),
a subclass of `rml:TriplesMap`.
A Triples Map of subclass [=non-asserted Triples Map=] does not generate [asserted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-asserted),
but might generate [quoted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted) if it is used in a [=Star Map=].

The following example is different than the previous in that `<#innerTriplesMap>` is declared to be an instance of `rml:NonAssertedTriplesMap`, with the effect that the generated "type" triples are only present in the resulting graph as [quoted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted), not as [asserted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-asserted):

<pre class="ex-input">
# Contents of the ex:ConfidenceSource logical source
entity , class  , confidence
Alice  , Person , 0.8
Bobby  , Dog    , 0.6
</pre>

<pre class="ex-mapping nohighlight">
# Triples Map that generates "type" triples that are only quoted, not asserted
<#innerTriplesMap>
    <b>a rml:NonAssertedTriplesMap</b>;
    rml:logicalSource ex:ConfidenceSource;
    rml:subjectMap [
        rml:template "http://example.com/{entity}";
    ];
    rml:predicateObjectMap [
        rml:predicate rdf:type;
        rml:objectMap [ rml:template "http://example.com/{class}" ];
    ].

# Triples Map that generates "confidence" triples
<#outerTriplesMap>
    a rml:AssertedTriplesMap;
    rml:logicalSource ex:ConfidenceSource;
    rml:subjectMap [
        rml:quotedTriplesMap <#innerTriplesMap>;
    ];
    rml:predicateObjectMap [
        rml:predicate ex:confidence;
        rml:objectMap [ rml:reference "confidence" ];
    ].
</pre>

<pre class="ex-output">
<< ex:Alice a ex:Person >> ex:confidence 0.8 .
<< ex:Bobby a ex:Dog >> ex:confidence 0.6 .
</pre>


A summary of how to generate triples in any combination of [asserted](https://www.w3.org/2021/12/rdf-star.html#dfn-asserted) and/or [quoted triples](https://www.w3.org/2021/12/rdf-star.html#dfn-quoted) is given in the following table, where `rml:TriplesMap` refers to instances of `rml:TriplesMap` that are not of the `rml:NonAssertedTriplesMap` subclass:

<nop>| Quoted | Not quoted
-|-|-
**Asserted**| `rml:TriplesMap` *with* `rml:StarMap`| `rml:TriplesMap` *without* `rml:StarMap`
**Asserted**| `rml:AssertedTriplesMap` *with* `rml:StarMap`| `rml:AssertedTriplesMap` *without* `rml:StarMap`
**Not asserted**| `rml:NonAssertedTriplesMap` *with* `rml:StarMap`|  -

It should be noted that Non Asserted Triples Maps that are not quoted do not generate any triple. For this reason, the use of `rml:NonAssertedTriplesMap` **without** `rml:StarMap` **is not allowed**. `rml:NonAssertedTriplesMap` must always be called with `rml:quotedTriplesMap`.
